import{_ as W,r as n,c as T,o as m,a as e,n as $,t as k,h as me,v as he,x as _e,i as le,y as ge,z as ce,m as ie,f as ye,k as J,s as ve,d as X,u as C,w as G,F as pe,b as fe,g as M,p as P,l as ke,A as de,B as we,C as ne,D as be,E as Me,G as Te,H as Ee,T as Se,I as re,K as xe}from"./index--Yzb7obU.js";import{u as Ce}from"./useDramaStore-JKIbRy_r.js";import{P as De}from"./Page-CgeAHWAu.js";import{u as Ie}from"./useDramaInfo-DCDf4g0i.js";const Ve={class:"container"},Pe=["src","alt"],$e={class:"name"},Re={__name:"ShareDrawer",props:{name:String,url:String},emits:["onShare"],setup(D,{emit:l}){const u=n(!1),a=D,i=l,f=()=>{u.value=!u.value,u.value?i("onShare",1):i("onShare",-1)};return(h,w)=>(m(),T("div",Ve,[e("img",{src:a.url,alt:a.name,class:$(["avater",{active:u.value}]),onClick:f},null,10,Pe),e("p",$e,k(a.name),1)]))}},Be=W(Re,[["__scopeId","data-v-80782aac"]]),Ye={class:"container"},je={class:"content"},Ae={class:"button-group"},Ne={__name:"EndingInfo",emits:["onToEpisodeMode"],setup(D,{emit:l}){const u=l;return(a,i)=>(m(),T("div",Ye,[e("div",je,[i[2]||(i[2]=e("div",{class:"info"},"喜欢就追剧吧！",-1)),e("div",Ae,[e("button",{onClick:i[0]||(i[0]=f=>u("onToEpisodeMode",1)),onTouchend:i[1]||(i[1]=f=>u("onToEpisodeMode",1))}," 详情 ",32)])])]))}},Le=W(Ne,[["__scopeId","data-v-6d3c8462"]]),Xe="/yike/assets/avater_jungle-Bs4RDHT7.jpg",We="/yike/assets/avater_cat-HovCB-jK.jpg",He="/yike/assets/avater_junhe-DwWDvfFe.jpg",Oe="/yike/assets/avater_sister-ClxQgNX_.jpg",Fe="/yike/assets/avater_ji-DoZre7CM.jpg",Ue="/yike/assets/avater_gebi-2s7w_hoP.jpg",qe="/yike/assets/avater_weixin-C4iPkpS4.jpg",ze={class:"play"},Ke={key:0,class:"fa-solid fa-volume-xmark fa-2xl"},Ge={key:1,class:"fa-solid fa-volume-low fa-2xl"},Je={class:"share-title"},Qe={class:"share-drawer",id:"share-drawer"},Ze={class:"episode-drawer"},ea={class:"episode-info"},aa=["src","alt"],ta={class:"text"},sa={class:"title"},oa={class:"details"},na={class:"head"},la={class:"content"},ia={class:"episode-select"},da=["id","poster"],ra=["src"],ua={class:"bottom"},ue=30,ca={__name:"PlayBar",props:{Playing:{type:Boolean},videoInfo:{type:String},videoIsPlaying:{type:Boolean},eid:{type:Number},episode:{type:Number},episode_total:{type:Number},img:{type:String},is_vip:{type:Number},title:{type:String},url:{type:String},url2:{type:String},vid:{type:Number}},emits:["onEpisode","onVideoReady"],setup(D,{emit:l}){const u=me(),a=D,i=Ce(),f=n([{name:"微信好友",url:qe},{name:"Jungle",url:Xe},{name:"萝莉岛主",url:We},{name:"中非小炮弹",url:He},{name:"弈",url:Oe},{name:"鸡鸡一柱擎天",url:Fe},{name:"隔壁小孩",url:Ue}]),h=he(),w=_e();let r=0,_=0,y=!1;const R=i.isLiked(a.vid),x=i.isCollected(a.vid),b=n(!1),g=w.getIsMute(),E=n(!1),S=n("分享给朋友"),Q=n("剧集信息"),H=n(`一刻短剧由Dano基于Apifox公开项目
    「悦享好剧」开发，仅做学习研究使用。
    若有Bug请发邮件或在GitHub中提出issue。
    主要技术栈：「 Vue 」「 Vite 」「 Pinia 」「 Vue Router 」`),Z=n(null),O=()=>{i.toggleLike(a.vid)},I=n(!1);let c=null;const F=o=>{o?c.play():c.pause()},B=()=>{c.muted(g.value)},U=o=>{o.stopPropagation(),o.preventDefault(),g.value=!g.value,M(g.value?"静音开启":"静音解除"),c.muted(g.value)},Y=o=>{o.stopPropagation(),o.preventDefault(),i.toggleCollection(a.vid),M(x.value?"收藏成功":"收藏移除")};function q(o){const s=o.touches?o.touches[0]:o;r=s.clientX,_=s.clientY,y=!1}function j(o){if(!r||!_)return;const s=o.touches?o.touches[0]:o,V=s.clientX,p=s.clientY,L=Math.abs(V-r),oe=Math.abs(p-_);Math.sqrt(L*L+oe*oe)>ue&&(y=!0)}function A(o){!r||!_||(y||(c.paused()?(c.play(),M("继续播放")):(c.pause(),M("暂停播放"))),r=0,_=0)}function z(o){r=o.clientX,_=o.clientY,y=!1}function ee(o){if(!r||!_)return;const s=o.clientX,V=o.clientY,p=Math.abs(s-r),L=Math.abs(V-_);Math.sqrt(p*p+L*L)>ue&&(y=!0)}function K(o){!r||!_||(y||(c.paused()?(c.play(),M("继续播放")):(c.pause(),M("暂停播放"))),r=0,_=0)}le(()=>{let o={height:"1415",width:"795.94",aspectRatio:"9:16",controlBar:{fullscreenToggle:!1,playToggle:!1,volumeMenuButton:!1,timeDivider:!1,volumePanel:!1,pictureInPictureToggle:!1,remainingTimeDisplay:!1},userAction:{click:!0,doubleClick:!1},controls:!0};c=ge(a.videoInfo,o,function(){v("onVideoReady",1),h.setIsReady()}),c.on("play",()=>{i.updateWatchRecord(a.vid,a.eid),I.value=!1}),c.on("pause",()=>{}),c.muted(g.value),c.on("ended",function(){I.value=!0})}),le(()=>{F(a.Playing),B()}),ce(a,()=>{F(a.Playing),B()});const N=n(0),ae=ie(()=>!!N.value),t=o=>{N.value+=o,console.log(N.value)},v=l,d=()=>{E.value=!0,v("onEpisode",!0)},te=()=>{v("onEpisode",!1)},se=()=>{ke.push("/detail"),u.setVidAndShowDetail(a.vid),E.value=!1};return(o,s)=>{const V=ye("el-drawer");return m(),T("div",ze,[e("div",{class:"tab",ref_key:"tab",ref:Z},[e("div",{onClick:O,onTouchend:O},[e("i",{class:$(["fa-solid fa-heart fa-2xl",{"active-like":C(R)}])},null,2),s[6]||(s[6]=e("p",null,"12.3万",-1))],32),e("div",{onClick:Y,onTouchend:Y},[e("i",{class:$(["fa-solid fa-star fa-2xl",{"active-favorite":C(x)}])},null,2),s[7]||(s[7]=e("p",null,"1.9万",-1))],32),e("div",{onClick:s[0]||(s[0]=p=>b.value=!0),onTouchend:s[1]||(s[1]=p=>b.value=!0)},[...s[8]||(s[8]=[e("i",{class:"fa-solid fa-share fa-2xl"},null,-1),e("p",null,"0.9万",-1)])],32),e("div",{onClick:d,onTouchend:d},[s[9]||(s[9]=e("i",{class:"fa-solid fa-bars-staggered fa-2xl"},null,-1)),e("p",null,k(a.episode_total)+"集",1)],32),e("div",{onClick:U,onTouchend:U,class:"mute"},[C(g)?(m(),T("i",Ke)):(m(),T("i",Ge))],32),X(V,{"close-delay":200,modelValue:b.value,"onUpdate:modelValue":s[4]||(s[4]=p=>b.value=p),title:S.value,"with-header":!0,direction:"btt","lock-scroll":!0,"custom-class":"no-scroll-drawer","append-to":"#parent-container",size:"28%",class:"el-drawer"},{default:G(()=>[e("div",Je,[e("div",null,k(a.title)+"  第"+k(a.episode)+"集",1)]),e("div",Qe,[(m(!0),T(pe,null,fe(f.value,p=>(m(),J(Be,{onOnShare:t,key:p.name,name:p.name,url:p.url},null,8,["name","url"]))),128))]),e("button",{onClick:s[2]||(s[2]=p=>(b.value=!1,C(M)("分享成功"))),onTouchend:s[3]||(s[3]=p=>b.value=!1),class:$(["button share-button",{disabled:!ae.value}])}," 一键分享 ",34)]),_:1},8,["modelValue","title"]),X(V,{onClose:te,resizable:"",modelValue:E.value,"onUpdate:modelValue":s[5]||(s[5]=p=>E.value=p),title:Q.value,"with-header":!0,direction:"btt","lock-scroll":!0,"custom-class":"no-scroll-drawer","append-to":"#parent-container",size:"80%"},{default:G(()=>[e("div",Ze,[e("div",ea,[e("img",{src:a.img,alt:a.title},null,8,aa),e("div",ta,[e("div",sa,k(a.title),1),e("div",oa,[e("div",na,[e("div",null," 当前剧集   "+k(a.episode),1),e("div",{class:$({coll:C(x),normal:!C(x)})},k(C(x)?"已收藏":"未收藏"),3)]),e("div",la,k(H.value),1)])])]),e("div",ia,[e("div",{class:"button-group"},[e("button",{onClick:se},"详情")]),X(De,{vid:a.vid,onOnToEpisodeMode:se},{default:G(()=>[e("div",null,"全"+k(a.episode_total)+"集",1)]),_:1},8,["vid"])])])]),_:1},8,["modelValue","title"])],512),I.value?(m(),J(Le,{key:0,onOnToEpisodeMode:se,class:"end-info"})):ve("",!0),e("div",{class:$(["video",{"is-ended":I.value}]),onTouchstart:P(q,["prevent"]),onTouchmove:P(j,["prevent"]),onTouchend:P(A,["prevent"]),onMousedown:P(z,["prevent"]),onMousemove:P(ee,["prevent"]),onMouseup:P(K,["prevent"])},[e("video",{id:a.videoInfo,"webkit-playsinline":"true",playsinline:"ture",class:"vjs-control-bar video-js",preload:"auto",muted:"",poster:a.img},[e("source",{src:a.url2,type:"video/mp4"},null,8,ra)],8,da)],34),e("div",ua,[e("h3",null,k(a.title),1),e("small",null,"当前剧集 "+k(a.episode),1)]),s[10]||(s[10]=e("div",{class:"placeholder"},null,-1))])}}},va=W(ca,[["__scopeId","data-v-b1deb932"]]),pa={},fa={class:"container"},ma={class:"play"},ha={class:"tab",ref:"tab"};function _a(D,l){return m(),T("div",fa,[e("div",ma,[e("div",ha,[...l[0]||(l[0]=[de('<div data-v-8561a0a9><i class="fa-solid fa-heart fa-2xl" data-v-8561a0a9></i><p class="animation-placehoder" data-v-8561a0a9>      </p></div><div data-v-8561a0a9><i class="fa-solid fa-star fa-2xl" data-v-8561a0a9></i><p class="animation-placehoder" data-v-8561a0a9>      </p></div><div data-v-8561a0a9><i class="fa-solid fa-share fa-2xl" data-v-8561a0a9></i><p class="animation-placehoder" data-v-8561a0a9>      </p></div><div data-v-8561a0a9><i class="fa-solid fa-bars-staggered fa-2xl" data-v-8561a0a9></i><p class="animation-placehoder" data-v-8561a0a9>      </p></div><div data-v-8561a0a9><i class="fa-solid fa-volume-xmark fa-2xl" data-v-8561a0a9></i></div>',5)])],512),l[1]||(l[1]=de('<div class="video" data-v-8561a0a9><div class="loading-container" data-v-8561a0a9><div class="loding-div animation-loading" data-v-8561a0a9></div><div class="loding-div animation-loading-reverse" data-v-8561a0a9></div></div><div class="text" data-v-8561a0a9>一刻加载中...</div></div><div class="bottom" data-v-8561a0a9><h3 class="animation-placehoder" data-v-8561a0a9> </h3><small class="animation-placehoder" data-v-8561a0a9> </small></div><div class="placeholder" data-v-8561a0a9></div>',3))])])}const ga=W(pa,[["render",_a],["__scopeId","data-v-8561a0a9"]]),ya={key:0,class:"loading-page"},ka={__name:"Video",setup(D){const l=we();ie(()=>l.params.vid&&l.params.eid?(console.log("playMode",!0),!0):(console.log("playMode",!1),!1)),n(l.params.vid),n(l.params.eid);const u=n(!1),a=n(0),i=n(0),f=n(0),h=n(0),w=n([]),r=n(null),_=Ie(),y=n(80),R=n(!1),x=async(t,v)=>{R.value=!0,t&&v?w.value=await re(t,v):w.value=await re(),w.value.forEach(d=>{_.updateDramaInfo(d)}),R.value=!1},b=ne.debounce(x,100),g=async()=>{h.value<w.value.length-1?(h.value++,S()):(M("到底了"),await b(l.params.vid,l.params.eid),setTimeout(()=>{h.value=0,S()},400))},E=()=>{h.value>0?(h.value--,S()):M("到顶了")},S=(t=!0)=>{if(r.value){const d=r.value.getBoundingClientRect().height;t?r.value.scrollTo({top:h.value*d,behavior:"smooth"}):r.value.scrollTo({top:h.value*d})}},Q=()=>{if(r.value){const v=r.value.getBoundingClientRect().height,d=h.value*v-f.value;r.value.scrollTo({top:d,behavior:"smooth"})}},H=ne.debounce(Q,5),Z=t=>{t.preventDefault(),u.value=!0,a.value=t.touches[0].clientY,i.value=a.value},O=t=>{if(!u.value)return;const v=t.touches[0].clientY;f.value+=v-i.value,i.value=v,H()},I=t=>{t.preventDefault(),u.value&&(u.value=!1,f.value>y.value?E():f.value<-y.value?g():S(),f.value=0)},c=t=>{u.value=!0,a.value=t.clientY,i.value=a.value},F=t=>{if(t.stopPropagation(),!u.value)return;const v=t.clientY;f.value+=v-i.value,i.value=v,H()},B=t=>{t.stopPropagation(),u.value&&(u.value=!1,f.value>y.value?E():f.value<-y.value?g():S(),f.value=0)},U=t=>{t.preventDefault(),t.deltaY>0?g():E()},Y=ne.debounce(U,200),q=t=>{t.preventDefault(),t.key==="ArrowDown"?g():t.key==="ArrowUp"&&E()};be(async()=>{await b(l.params.vid,l.params.eid)});const j=()=>{window.addEventListener("keyup",q),window.addEventListener("wheel",Y)},A=()=>{window.removeEventListener("keyup",q),window.removeEventListener("wheel",Y)};ce(l,()=>{b(l.params.vid,l.params.eid),h.value=0,M("切换中...")}),le(()=>{S(),j()}),Me(()=>{S(),j()}),Te(()=>{A()}),Ee(()=>{A()});const z=n(!1),ee=t=>{t?(z.value=!0,A()):(z.value=!1,j())},K=n(0),N=ie(()=>K.value>=w.value.length&&w.value.length!=0&&!R.value),ae=t=>{K.value+=t};return(t,v)=>(m(),T("div",{ref_key:"videoElement",ref:r,class:"video-container",onTouchstart:Z,onTouchmove:O,onTouchend:I,onMousedown:c,onMousemove:F,onMouseup:B,onMouseleave:B},[X(Se,null,{default:G(()=>[(m(),J(xe,null,[N.value?ve("",!0):(m(),T("div",ya,[X(ga)]))],1024))]),_:1}),(m(!0),T(pe,null,fe(w.value,(d,te)=>(m(),J(va,{onOnVideoReady:ae,onOnEpisode:ee,class:"play",key:d.eid,videoInfo:`video${d.title}${d.eid}`,eid:d.eid,episode:d.episode,episode_total:d.episode_total,img:d.img,is_vip:d.is_vip,title:d.title,url:d.url,url2:d.url2,vid:d.vid,Playing:te==h.value},null,8,["videoInfo","eid","episode","episode_total","img","is_vip","title","url","url2","vid","Playing"]))),128))],544))}},Sa=W(ka,[["__scopeId","data-v-bad293ad"]]);export{Sa as V};
