<div align="center">

![logo](/logo.png) ![](/icon.png)

# 一刻短剧

![](https://img.shields.io/badge/Sass-953357) ![](https://img.shields.io/badge/Vite-FFAB00) ![](https://img.shields.io/badge/JSes6-FFCA28) ![](https://img.shields.io/badge/Pinia-fFD551) ![](https://img.shields.io/badge/Vue3-41B883) ![](https://img.shields.io/badge/ElementPlus-44A3FF) ![](https://img.shields.io/badge/CSS3-7E57C2)

</div>

### 项目地址

[一刻短剧：](https://danoandholidays.github.io/yike/)https://danoandholidays.github.io/yike/ _推荐使用移动设备打开_

### 项目介绍

**一刻短剧** 基于Apifox公开项目 **「悦享好剧」** 开发，仅做学习研究使用。由于短剧竖屏播放，所以全面**模仿抖音**，专注于短剧的竖屏播放体验，前端界面将模仿抖音的交互与视觉风格。

也算是我之前开发的网站 [PLAYLET-APP](https://danoandholidays.github.io/PLAYLET-APP/) 的二次开发。之前的项目，原生开发功能全靠手撸，所以有很多问题和没有写完的部分，我也不打算改了，直接重新写一个。

若有Bug请发邮件或在GitHub中提出issue。

### 功能实现

- 「首页」类抖音滑动加载、微信分享短剧（随机的短剧，观看记录、收藏与喜欢（存储于本地
- 「分类」短剧分类
- 「上传」调用摄像头，记录生活
- 「剧集」剧集信息、选集信息与观看信息、详情页
- 「我的」个人信息展示（数据存储于本地

<p align="center">
  <img src="home.gif" width="200" style="display:inline-block;" />
  <img src="category.gif" width="200" style="display:inline-block;" />
  <img src="episode.gif" width="200" style="display:inline-block;" />
  <img src="mine.gif" width="200" style="display:inline-block;" />
</p>
（有展示GIF，可能加载较慢）

### API与请求库

基于Apifox悦享好剧开发（希望项目一直开放...）但仅有短剧相关、分类的部分。使用Axios发送请求

### 适配问题

- 适配绝大多数的桌面浏览器，推荐在浏览器中开启**开发者模式**（按F12）并切换**设备仿真**为安卓机型，体验移动端效果
- 目前苹果机型不能自动播放

---

### 项目路线图

1.  **第一阶段 (核心体验)**：实现基于Video.js的单视频播放器，验证服务器Range请求与拖拽功能。✅
2.  **第二阶段 (核心交互)**：开发上下滑动的容器组件，实现视频的切换逻辑与基本预加载。（重难点）✅
3.  **第三阶段 (优化与扩展)**：完善UI细节（加载状态、错误处理）、用户系统（点赞、收藏）、剧集选择等功能。✅

---

# 开发日志&碎碎念

### 8.24.25

最开始的架构设计和学习阶段

### 9.17.25

- 每次请求15条，再维护一个数组，存三条，上划一条，当前一条，下滑一条。
- 当15条请求的12条的时候，再次请求，覆盖请求，但是最多15条。
- 初步完成了滑动切换视频，`overflow: scroll`我能记得一辈子你

### 9.18.25

- 今天把点击和滑动区分一下
- 折腾半天，添加了滚轮、上下键和鼠标手指的滑动切换视频功能，添加了props所传递的数据。有点不太跟手，但是效果还是可以的，太跟手可能会影响性能，所有频繁触发的事件处理函数handle都对应添加了节流和防抖，lodash的库还真是好用🥵👍
- 滑动切换视频这个功能基本上是完成了

### 9.19.25

- 接下来就是维护视频队列了，由最初的3条->5条，动态更新队列时，滚动会出现一些问题✅
- 再把Element的message框的样式修改一下，区分点击和滑动
- 添加暂停、结束播放的样式，添加视频poster✅

### 9.20.25

- 将Element的message框的样式修改一下，改为了黑底白字，区分点击和滑动✅
- 使用Pinia新建一个store，用来存储用户信息，并且使用插件[pinia-plugin-persistedstate](https://github.com/prazdevs/pinia-plugin-persistedstate)实现浏览器本地存储✅
- 设计开屏界面，使用Pinia存储应用运行信息，便于管理✅
- 将其余的三页框架搭建起来，而且还重构了项目架构，组件之间的关系更加合理✅

核心的随机短剧功能已经完成，剩余时间将静态的界面写完

### 9.21.25

- 优化抽屉的绑定位置，添加静态的我的页

今天玩了一天，啥也没干😅另外就是GIF必须直接放在根目录，在文件夹里README显示不了

- 改了一下Message的样式，添加了一个灰色的边框#323232

### 9.22.25

### 9.23.25

- 完成了静态的我的页✅

### 9.24.25

- test Actions。已成功配置简单的CI/CD流程，push时部署✅

### 9.25.25

- 优化抽屉的绑定位置，修改EL主题

### 9.25.25

- 完成分享抽屉的逻辑与样式

- 设计分页器，实现短剧的追剧模式，经我检查，手机很少用分页器，还是直接渲染吧。
- 完成对集数信息的渲染，页面很漂亮

### 9.26.25

- 优化抽屉样式，添加模糊，提示用户下滑修改交互逻辑，占70%屏幕，overflow区域也改为基于视口大小✅

- 优化了键盘和滚动的逻辑，在呼出剧集抽屉的时候，不会触发短视频组的滚动✅

- 添加加载动画，使用Keepalive与Transition组件实现丝滑过渡✅

- 构建本地剧集信息：应该构建一个类，使用构造函数初始化剧集信息存储对象。✅

- 添加完播后的追剧按钮，处理函数与剧集抽屉一致✅

- 优化加载页面的placeholder样式，与播放器对齐✅

### 9.27.25

- 在剧集播放完后，会弹出类似剧集抽屉的内容，让用户去选择，追剧模式还是继续随机。✅

- 本地剧集信息：包括，是否喜欢，收藏，播放历史，观看记录（包括观看过的短剧与其集数）。虽然这样做可能会增加存储空间的消耗，但是也就不到1kb。使用这种方式，只能够在一个浏览器中保存观看记录。用户可以手动清除。✅

- 在使用使用了 pinia-plugin-persistedstate 或类似插件（{ persist: true }），它会把 state 转成 JSON 存在 localStorage。而Set和Map是不能够进行JSON化的。需要改进。✅

- 追剧和收藏的逻辑很像，就不做区分了。✅

- 使用nextTick和 **函数式 ref** 的写法完成了观看过的剧集和正在观看的剧集的展示，与滚动。✅

### 9.28.25

- 构建了剧集页的框架。
- 由于没有请求剧集信息的接口，只能本地化剧集信息，再使用剧集请求接口来实现。
- 本质上应该将这两个Pinia合一的，但是之前使用的结构有点复杂，我不想改怕Bug

- 这老bug有点烦人啊

- 通过本地剧集数据查找与请求接口的改造使用，实现了收藏tab的数据展示。

### 9.30.25

- 剧集页将内容改换为喜欢、收藏、历史等分类。修改剧集页的展示，重新设计不同的卡片，切换收藏，喜欢等功能。观看历史使用平铺三列，其余卡片保持横条，分别做收藏和喜欢按钮。

- 改进了写法keepalive组件写法

```HTML
<router-view v-slot="{ Component }">
    <keep-alive :include="keepAliveList">
        <component :is="Component" />
    </keep-alive>
</router-view>
```

### 10.1

- 在 Vue 3 中，当你为事件绑定一个方法时，应该直接传递方法名，不需要加上括号，否则 Vue 会错误地解析事件。
- 分类页也采用平铺三列，首页点击直接跳转到分类页，分类页剧集卡片单独设计，设计TOP1，2，3特殊样式，其余依次排开，分类页点击也跳转详情页。分类页采用爱奇艺，优酷那种样式设计
- 添加播放完成后的追剧功能，使用和侧边栏的同一接口本质是跳转到详情页，获取历史，并且找到对应的播放集数
- 用户点击追剧模式，就会自动的跳转到详情播放页，在剧集页中可以进入详情页
- 从所有的卡片点击，均会进入详情页。详情页可以进行机会对剧集的所有操作。和抽屉很像，抽屉添加按钮，详情按钮。添加返回按钮

### 10.2

- 优化加载placeholder的出现时机
- 我之前用那么多pinia干什么呢，直接用路由参数多好，而且更合理，url也符合风格🤡
- 详情页播放组件属于特殊页，与详情页一样，会单开一个路由

### 10.5

- 今天修了一些bug，这个项目暂时就不会再继续写了，等有新的想法再说吧，我会持续的将新的知识集成到这个项目。
- 这是一个常见的浏览器安全限制，尤其是在自动播放音视频时。现代浏览器为了防止打扰用户，通常要求用户与页面进行某种交互（例如点击、触摸等）后，才能播放音频或视频。因此，如果在没有用户交互的情况下调用 play() 方法，就会出现这个错误。
- 懒加载路由 首页没有路由懒加载2.03s、1.59s、1.84s、2.00s、1.81s、1.84、1.90s、1.99s、1.87s、1.81s。使用懒加载1.66s、1.91s、1.86、1.87s、1.82s、1.57s、1.80s、1.83s、2.10s、1.80s。对于现代网页应用来说，2 秒以内的加载时间通常是可以接受的。尽管使用了懒加载，平均加载时间略微减少（大约减少了 0.03 秒）。这表明懒加载确实有一些优化效果，但差异不大。这也意味着首页的大小可能并没有达到需要通过懒加载优化的程度。懒加载对首页加载时间的影响较小，因为首页可能本身并不庞大，使用懒加载后，平均加载时间略微减少，但变化幅度较小，加载波动有所增加。最终还是采用首页的懒加载

### 未来展望...

- 代码分割、资源压缩和图片延迟加载等
- cookie，头像上传

- 优化并发请求的性能问题

- 如果闲的话添加微信分享功能，这个功能就抽离朱来，做为一个单独的js模块来实现，不在组件内部写
